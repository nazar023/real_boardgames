<div class = 'flex flex-row justify-center items-center'>
  <% if !current_user %>
    <div>
      <%= link_to "Log in", new_user_session_path %> |  <%= link_to "Sign up", new_user_registration_path %>
    </div>
  <% else %>

  <%= turbo_stream_from "#{dom_id(current_user)}_notifications" %>
   <div data-controller="notification-dropdown" class="relative">
      <button id = 'notification_button' type="button"
              data-action="notification-dropdown#toggle
                           click@window->notification-dropdown#hide">
      <% if current_user.notifications.present?%>
        <div id = 'notification_pulsing_element' class = 'absolute right-0 animate-pulse bg-red-600 rounded-full h-2 w-2'>
        </div>
      <% end %>
        <%= image_tag('notifications.png', class: 'h-6 w-6')%>
      </button>
      <div
        id = "notification_window"
        data-notification-dropdown-target="menu"
        class="hidden transition transform origin-top-right absolute w-96 right-0 bg-slate-500 py-5"
        data-transition-enter-from="opacity-0 scale-95"
        data-transition-enter-to="opacity-100 scale-100"
        data-transition-leave-from="opacity-100 scale-100"
        data-transition-leave-to="opacity-0 scale-95"
      >
        <div id = 'notifications' class = 'flex flex-col px-4'>
            <div id = notifications_message>
              You got <span id = notification_counter> <%= current_user.notifications.count %> </span> notifications
            </div>
            <% if policy(current_user).has_notifications? %>
              <%= render "notifications/notifications", user: current_user, notifications: current_user.notifications%>
            <% end %>
        </div>
      </div>
    </div>

    <div id = 'avatar' class = ' shrink-0 px-4'>
      <% if current_user&.avatar&.attached? %>
        <%= image_tag(current_user.avatar, class: "navbar_avatar") %>
      <% else %>
        <%= image_tag("guestavatar1.png", class: "navbar_avatar") %>
      <% end %>
    </div>


    <div>
      <p> <%= current_user.email%> </p>
      <p> <%= link_to "Profile", user_profile_path(current_user.id)%> </p>
      <p> <%= link_to "Edit", edit_user_registration_path%> </p>
      <p> <%= link_to "Exit", destroy_user_session_path, data: { turbo_method: :delete } %> </p>
    </div>
  <% end %>
</div>
